alerts:
  - rule: DEPLOYMENT_FAILED
  - rule: DOMAIN_LIVE
  - rule: DOMAIN_FAILED
databases:
  - cluster_name: aqaratech-db-cluster-1
    engine: PG
    name: aqaratechdb
    num_nodes: 1
    size: db-s-dev-database
    version: "14"
    production: true
domains:
  - domain: aqaratech.com
    type: PRIMARY
envs:
  - key: PUBLIC_SITE_URL
    scope: RUN_AND_BUILD_TIME
    value: ${APP_URL}
  - key: PUBLIC_API_URL
    scope: RUN_AND_BUILD_TIME
    value: ${aqaratech-api.PUBLIC_URL}
  - key: PUBLIC_API_URL_LOCAL
    scope: RUN_AND_BUILD_TIME
    value: ${aqaratech-api.PRIVATE_URL}
  # - key: AUTH0_CLIENT_SECRET
  # value: uSR4Gjf3XNN-1kfZGuppDqRdbz7XD6A4o2g8yY1GdZgqCXeYhWhdqfPUoIIJLBRf
  # scope: RUN_AND_BUILD_TIME
  # type: SECRET
  - key: AQ_DEBUG_NEST
    scope: RUN_AND_BUILD_TIME
    value: "0"
  - key: AQ_DEBUG_PRISMA
    scope: RUN_AND_BUILD_TIME
    value: "0"
name: aqaratech-app-prod
region: fra
services:
  - envs:
      - key: DATABASE_URL
        scope: RUN_AND_BUILD_TIME
        value: ${aqaratechdb.DATABASE_URL}
    health_check:
      http_path: /health
    http_port: 3002
    image:
      registry_type: DOCR
      repository: aqaratech-api
      tag: latest
    instance_count: 1
    instance_size_slug: professional-s
    # log_destinations:
    #   - logtail:
    #       token: uxNpiF4y2RbpN15nPsq3zuZB
    #     name: logtail-do-addon
    name: aqaratech-api
    routes:
      - path: /api
  - health_check:
      http_path: /
    http_port: 3000
    image:
      registry_type: DOCR
      repository: aqaratech-site
      tag: latest
    instance_count: 1
    instance_size_slug: professional-xs
    # log_destinations:
    # - logtail:
    #     token: uxNpiF4y2RbpN15nPsq3zuZB
    #   name: logtail-do-addon
    name: aqaratech-site
    routes:
      - path: /
