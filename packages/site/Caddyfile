{
  log
  debug
}

:2016, :3005

handle /api/auth/* {
  reverse_proxy localhost:3000 {
    header_up Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
    header_up X-Real-IP {remote}
  }
}

# TODO replace with url
reverse_proxy /v1/* localhost:3002 {
  header_up Host {upstream_hostport}
  header_up Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
  header_up X-Real-IP {remote}
}

@notapi {
  not path *api*
}
reverse_proxy @notapi localhost:3000 {
  header_up Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
  header_up X-Real-IP {remote}
}
